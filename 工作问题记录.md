#### npm publish是出现`not permitted unlink`

可能有两种情况导致

1. 没有登录，使用`npm login`进行登录后再操作
2. `register`注册源被修改，使用`npm config set register value`进行修改

2020-05-14

#### node获取文件所在路径

使用`__dirname`可以获取文件所在的文件夹绝对路径;

`__filename`可以获取文件绝对路径;

`process.cwd()`可以获取调用时所在路径;


2020-05-14

#### 调用git commit api是出现{message: "9:branch diverged}
在相同的`repository`和相同的`branch`发起git commit api，特别是这个文件还没有被提交;


#### 如何git commit api 提交文件夹？


#### shell `<`号作用

`shell`的`<`小于号表示一个输入重定向; 对应 `>`大于号表示输出重定向;

所谓输入重定向是指：内容输入不是从键盘输入，而是从文件输入;
所谓输出重定向是指：内容不是输出到屏幕中，而是输出到文件中;

今天再用`curl`提交时用到这个方法:
```
curl --request post https://**********
--form "content=</lib/commit.sh"
```
content字段值是commit.sh文件的内容;


2020-05-14

#### 如何将一个repository的代码提交到另一个repository中？

使用gitlab api来实现这个功能，[对应接口](https://docs.gitlab.com/ee/api/commits.html#create-a-commit-with-multiple-files-and-actions)

通过curl方式来调用这个接口，需要注意的下面几点: 

1. 需要提交每个文件的信息不能提交一个文件夹;
2. 不能在当前分支去提交，会导致`Branch diverged`错误;

2020-05-14

#### npm install做了什么？

1. 读取`package.json`文件`dependencies`和`devDependencies`属性值;
2. 将`dependencies`和`devDenpendencies`属性值中每个模块作为根节点;
3. 找到每个根节点依赖的所有节点，并生成依赖树;
4. 寻找依赖树中相同的模块，判断是否可以兼容, 如果可以兼容则压平依赖树（请求register服务）;
5. 将模块下载到./npm目录中，通过版本号进行管理;
6. 最后从./npm中解压到本地node_modules文件夹中;

2020-05-14

#### npm设置node_modules引用地址

npm cache

npm offline等等

NODE_PATH 

2020-05-14

#### yum安装模块原理

`yum`是linux上一个包管理工具。通过命令行的方式运行，用法很像`npm`。

2020-05-14

#### chcp命令是什么？

`chcp`是windows改变cmd代码页(字符编码)的命令;

`chcp`显示当前代码页

`chcp xxx`设置代码页;


2020-05-14

#### 为什么yarn --f-g安装这么快？

`yarn install --frozne-lock`方法


2020-05-14

#### 在测试机上无法安装node-sass模块（已解决）

`node-sass`模块难安装是出了名，加上测试机没有翻墙功能导致npm install卡死。

`npm`有一个配置文件叫`.npmrc`，在执行`npm`命令时候会使用`.npmrc`里面的配置。

通过`npm config set key value`方式来设置配置，配置设置成功可以通过 `npm config ls -l`来展示;

我们通过设置镜像地址和node-sass地址来解决卡死的问题

```shell
npm config set registry https://registry.npm.taobao.org
npm config set phantomjs_cdnurl https://npm.taobao.org/dist/phantomjs
npm config set sass_binary_site https://npm.taobao.org/mirrors/node-sass/
```

2020-5-13  


#### 如何用dart-sass替换node-sass模块（已解决）

`webpack`的`sass-loader`默认使用`node-sass`作为sass编译模块的。

通过`sass-loader`在options中暴露一个字段`impentions`用来使用其他sass编译模块, 配置如下

```javascript
   {
      type: sass-loader
      options: {
          implementation: require("sass") //require("dart-sass")
      }
   }  
```

2020-5-13


#### shell curl脚本多行命令运行失败（已解决）

当一行脚本很长时，可以使用反斜杠`\`来分割脚本，注意是`\`后面不能有空格（我理解是多的空格会导致shell编译器分割错误)
```
curl --request POST "${HOST}${CI_PROJECT_ID}/merge_requests" \
--header PRIVATE-TOKEN:${GITLAB_PRIVATE_TOKEN} \
--form id=${CI_PROJECT_ID} \
--form title=${CI_COMMIT_REF_NAME} \
--form source_branch=${CI_COMMIT_REF_NAME} \
--form target_branch=${TARGET_BRANCH}; 
```

2020-05-13

#### 如何yaml中执行带有变量的字符串命令（未解决）

错误代码如下
```yaml
variable:
  PROJECT_NAME: demo

job1: 
  stage: build
  script:
    - ../${PROJECT_NAME}/node_modules/.bin/jest
```
当runner执行job1时，会出现
```
../${PROJECT_NAME}/node_modules/.bin/jest 路径不存在
```
按理说应该会解析成：
```
../demo/node_modules/.bin/jest
```
2020-5-12  

#### gitlab ci/cd 如何在一个手动任务之后运行一个自动化任务 (未解决)

`gitlab v11`版本中存在job执行顺序问题: 没法实现一个自动任务在一个手动任务运行之后自动执行? 

`gitlab v11`默认逻辑: 一次把所有自动化任务都执行完;

2020-5-12  

#### npm ci 和 npm i区别是什么？(未解决)

2020-5-12  




